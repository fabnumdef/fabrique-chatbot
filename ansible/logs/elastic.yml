---

# Prerequisites: SSH access for user with password

- hosts: localhost

  remote_user: fab_user

  vars:
    - ansible_become_pass: "{{ USER_PASSWORD }}"

- name: install metricbeat
  import_playbook: metricbeat.yml
  vars:
    USER_PASSWORD: "{{ USER_PASSWORD }}"
    ELASTIC_HOST: "{{ ELASTIC_HOST }}"
    ELASTIC_USERNAME: "{{ ELASTIC_USERNAME }}"
    ELASTIC_PASSWORD: "{{ ELASTIC_PASSWORD }}"
    ELASTIC_METRICBEAT_INDEX: "{{ ELASTIC_METRICBEAT_INDEX }}"

- name: install packetbeat
  import_playbook: packetbeat.yml
  vars:
    USER_PASSWORD: "{{ USER_PASSWORD }}"
    ELASTIC_HOST: "{{ ELASTIC_HOST }}"
    ELASTIC_USERNAME: "{{ ELASTIC_USERNAME }}"
    ELASTIC_PASSWORD: "{{ ELASTIC_PASSWORD }}"
    ELASTIC_PACKETBEAT_INDEX: "{{ ELASTIC_PACKETBEAT_INDEX }}"

- name: install filebeat
  import_playbook: filebeat.yml
  vars:
    USER_PASSWORD: "{{ USER_PASSWORD }}"
    ELASTIC_HOST: "{{ ELASTIC_HOST }}"
    ELASTIC_USERNAME: "{{ ELASTIC_USERNAME }}"
    ELASTIC_PASSWORD: "{{ ELASTIC_PASSWORD }}"
    ELASTIC_FILEBEAT_INDEX: "{{ ELASTIC_FILEBEAT_INDEX }}"
